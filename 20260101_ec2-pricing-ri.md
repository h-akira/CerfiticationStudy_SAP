# EC2 料金・リザーブドインスタンス

作成日: 2026-01-01

## 概要

EC2の料金モデルには複数のオプションがあり、リザーブドインスタンス（RI）とSavings Plansではインスタンスサイズの柔軟性が提供されます。正規化係数を理解することで、効率的なコスト最適化が可能です。

## 料金モデル比較

| モデル | 前払い | 契約期間 | 割引率 | 柔軟性 | 用途 |
|---|---|---|---|---|---|
| **オンデマンド** | なし | なし | なし（定価） | 最高 | 短期・不規則ワークロード |
| **リザーブドインスタンス（RI）** | あり/なし | 1年/3年 | 最大75% | 中 | 予測可能なワークロード |
| **Savings Plans** | あり/なし | 1年/3年 | 最大72% | 高 | 柔軟なワークロード |
| **スポットインスタンス** | なし | なし | 最大90% | 低（中断あり） | 耐障害性ワークロード |
| **Dedicated Hosts** | 時間/RI | オプション | オンデマンドより安価 | 低 | ライセンス持ち込み |

## リザーブドインスタンス（RI）の種類

| タイプ | 前払い | 割引率 | 特徴 |
|---|---|---|---|
| **All Upfront（全額前払い）** | 全額 | 最大（〜75%） | 前払い後の時間料金なし |
| **Partial Upfront（一部前払い）** | 一部 | 中（〜60%） | 一部前払い + 時間料金割引 |
| **No Upfront（前払いなし）** | なし | 最小（〜40%） | 時間料金のみ割引 |

### RIのクラス

| クラス | 変更可能項目 | 払い戻し | 用途 |
|---|---|---|---|
| **Standard RI** | AZ、インスタンスサイズ（同一ファミリー内）、ネットワーク | なし | 長期・安定ワークロード |
| **Convertible RI** | インスタンスファミリー、OS、テナンシー、支払いオプション | 可能（交換） | 将来の変更可能性あり |

## 正規化係数（Normalization Factor）

### インスタンスサイズの正規化係数表

| サイズ | 正規化係数 | 例 |
|---|---|---|
| **nano** | 0.25 | - |
| **micro** | 0.5 | - |
| **small** | 1 | t3.small |
| **medium** | 2 | t3.medium |
| **large** | 4 | t3.large |
| **xlarge** | 8 | t3.xlarge |
| **2xlarge** | 16 | t3.2xlarge |
| **4xlarge** | 32 | t3.4xlarge |
| **8xlarge** | 64 | t3.8xlarge |
| **9xlarge** | 72 | - |
| **10xlarge** | 80 | - |
| **12xlarge** | 96 | - |
| **16xlarge** | 128 | t3.16xlarge |
| **18xlarge** | 144 | - |
| **24xlarge** | 192 | - |
| **32xlarge** | 256 | - |

**基準**: `small` = 1として、サイズが倍になるごとに係数も倍

### インスタンスサイズの柔軟性（Size Flexibility）

**Standard RI**（リージョンRIのみ）では、同一インスタンスファミリー・リージョン内でサイズを柔軟に適用可能。

#### 例1: m5.xlarge RI (正規化係数 8) を購入

以下の組み合わせに適用可能:

| 組み合わせ | 正規化係数の合計 | 適用可否 |
|---|---|---|
| m5.xlarge × 1 | 8 | ✓ 完全適用 |
| m5.large × 2 | 4 × 2 = 8 | ✓ 完全適用 |
| m5.medium × 4 | 2 × 4 = 8 | ✓ 完全適用 |
| m5.small × 8 | 1 × 8 = 8 | ✓ 完全適用 |
| m5.large × 1 + m5.medium × 2 | 4 + 4 = 8 | ✓ 完全適用 |
| m5.2xlarge × 1 | 16 | △ 半分のみ適用 |

#### 例2: t3.large RI (正規化係数 4) × 2台を購入

合計正規化係数 = 8

以下の組み合わせに適用可能:

| 組み合わせ | 正規化係数の合計 | 適用可否 |
|---|---|---|
| t3.xlarge × 1 | 8 | ✓ 完全適用 |
| t3.large × 2 | 4 × 2 = 8 | ✓ 完全適用 |
| t3.medium × 4 | 2 × 4 = 8 | ✓ 完全適用 |
| t3.small × 8 | 1 × 8 = 8 | ✓ 完全適用 |

### サイズ柔軟性の制限

| 項目 | Standard RI | Convertible RI |
|---|---|---|
| **リージョンRI** | サイズ柔軟性あり | サイズ柔軟性あり |
| **AZ固定RI** | サイズ柔軟性**なし** | サイズ柔軟性**なし** |
| **同一ファミリー内** | 可能 | 可能 |
| **異なるファミリー** | 不可 | Convertible交換で可能 |

**重要**: AZを指定した場合、サイズ柔軟性は適用されない（キャパシティ予約目的）

## Savings Plans

### 種類

| プラン | 適用範囲 | 柔軟性 | 割引率 |
|---|---|---|---|
| **Compute Savings Plans** | EC2、Lambda、Fargate | 最高（インスタンスファミリー、サイズ、AZ、リージョン、OS自由） | 最大66% |
| **EC2 Instance Savings Plans** | EC2のみ（特定リージョン・ファミリー） | 中（サイズ、AZ、OS自由） | 最大72% |

**Savings Plans vs RI**:
- Savings Plans: 時間あたりのコミット（$/hour）
- RI: 特定インスタンスタイプのコミット

## 料金計算例

### 例: m5.xlarge RI（All Upfront、3年、リージョンRI）

**前提**:
- オンデマンド: $0.192/時間
- RI（All Upfront 3年）: 約$0.112/時間相当（約42%割引）

**使用パターン1**: m5.xlarge × 1台を常時稼働
- **適用**: 完全適用（100%割引）

**使用パターン2**: m5.large × 2台を常時稼働
- 正規化係数: 4 × 2 = 8（m5.xlarge = 8と一致）
- **適用**: 完全適用（100%割引）

**使用パターン3**: m5.2xlarge × 1台を常時稼働
- 正規化係数: 16（m5.xlarge RI = 8）
- **適用**: 50%に割引適用、残り50%はオンデマンド料金

## RI購入戦略

### ベストプラクティス

| 戦略 | 説明 |
|---|---|
| **ベースライン購入** | 最小常時稼働容量をRIで確保 |
| **small単位購入** | 柔軟性最大化（smallを複数購入） |
| **リージョンRI優先** | サイズ柔軟性を活用 |
| **段階的購入** | 1年RI → 使用状況確認 → 3年RI |
| **Savings Plans併用** | RIで固定ワークロード、Savings Plansで変動分 |

### 購入サイズの選択

| 購入パターン | メリット | デメリット |
|---|---|---|
| **大きいサイズ1つ** | 管理シンプル | 柔軟性低い |
| **小さいサイズ複数** | 柔軟性高い | 管理複雑 |

**推奨**: medium〜large単位で購入（バランス）

## SAP試験の重要ポイント

### 正規化係数
- **基準**: small = 1
- **倍率**: サイズが倍 → 係数も倍
- **計算**: large(4) × 2 = xlarge(8) × 1

### サイズ柔軟性
- **リージョンRI**: サイズ柔軟性あり（同一ファミリー内）
- **AZ固定RI**: サイズ柔軟性なし（キャパシティ予約）
- **Convertible RI**: 交換可能（インスタンスファミリー変更も可）

### 割引率
- **All Upfront 3年**: 最大75%割引
- **Partial Upfront**: 中程度（60%前後）
- **No Upfront**: 最小（40%前後）

### Savings Plans
- **Compute Savings Plans**: 最高柔軟性、EC2/Lambda/Fargate
- **EC2 Instance Savings Plans**: 特定ファミリー、最大割引

### RIマーケットプレイス
- 不要なStandard RIを売却可能
- Convertible RIは売却不可（交換のみ）

### RI適用優先順位
1. AZ固定RI
2. リージョンRI（サイズ完全一致）
3. リージョンRI（サイズ柔軟性適用）
4. オンデマンド
